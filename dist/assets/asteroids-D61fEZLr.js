import"./main-DHHuibfa.js";class p{constructor(t){this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d");const i=this.canvas.parentElement;this.canvas.width=i.clientWidth,this.canvas.height=i.clientHeight,this.width=this.canvas.width,this.height=this.canvas.height,window.innerWidth<=768?this.canvas.style.margin="0":this.canvas.style.margin="0.4rem auto",this.activeBackground=document.getElementById("active-background"),this.pausedBackground=document.getElementById("paused-background"),this.score=0,this.lives=3,this.level=1,this.asteroids=[],this.bullets=[],this.gameLoop=null,this.isPaused=!1,this.isGameOver=!1,this.showStartScreen=!0,this.heartBlinkTime=0,this.isSmallScreen=window.innerWidth<=350,this.onScoreUpdate=null,this.onGameOver=null,this.onGameStart=null,this.onGamePause=null,this.onGameResume=null,this.onGameReset=null,this.loadImages(),this.ship={x:this.width/2,y:this.height-60,radius:this.isSmallScreen?12:15,width:this.isSmallScreen?30:40,height:this.isSmallScreen?30:40,invulnerable:!1,speed:7},this.updateBackgroundVisibility(),this.loadScores(),this.draw()}loadImages(){this.shipImage=new Image,this.shipImage.src="https://i.gifer.com/origin/a2/a2efb3cf71b7b2a95d8d0c6236f00c88_w200.webp",this.shipImageLoaded=!1,this.shipImage.onload=()=>{this.shipImageLoaded=!0},this.asteroidImage=new Image,this.asteroidImage.src="https://images.vexels.com/media/users/3/203033/isolated/preview/bad8b13b449cf80e9cdbf1c355d63f4f-ilustracion-de-gran-asteroide.png",this.asteroidImageLoaded=!1,this.asteroidImage.onload=()=>{this.asteroidImageLoaded=!0},this.bulletImage=new Image,this.bulletImage.src="/—Pngtree—red bullet effect light effect_7150008.png",this.bulletImageLoaded=!1,this.bulletImage.onload=()=>{this.bulletImageLoaded=!0}}updateBackgroundVisibility(){this.isPaused||this.showStartScreen?(this.activeBackground.classList.add("hidden"),this.activeBackground.classList.remove("visible"),this.pausedBackground.classList.add("visible"),this.pausedBackground.classList.remove("hidden")):(this.activeBackground.classList.add("visible"),this.activeBackground.classList.remove("hidden"),this.pausedBackground.classList.add("hidden"),this.pausedBackground.classList.remove("visible"))}loadScores(){const t=localStorage.getItem("asteroidsScores");this.scores=t?JSON.parse(t):{bestScore:0}}saveScores(){localStorage.setItem("asteroidsScores",JSON.stringify(this.scores))}start(){this.gameLoop||(this.showStartScreen=!1,this.isPaused=!1,this.isGameOver=!1,this.updateBackgroundVisibility(),this.initializeAsteroids(),this.gameLoop=setInterval(()=>this.update(),1e3/60),this.draw(),this.onGameStart&&this.onGameStart())}pause(){this.isPaused=!0,this.updateBackgroundVisibility(),this.draw(),this.onGamePause&&this.onGamePause()}resume(){this.isPaused=!1,this.updateBackgroundVisibility(),this.draw(),this.onGameResume&&this.onGameResume()}reset(){clearInterval(this.gameLoop),this.gameLoop=null,this.score=0,this.lives=3,this.level=1,this.asteroids=[],this.bullets=[],this.isPaused=!1,this.isGameOver=!1,this.showStartScreen=!0,this.ship={x:this.width/2,y:this.height-60,radius:this.isSmallScreen?12:15,width:this.isSmallScreen?30:40,height:this.isSmallScreen?30:40,invulnerable:!1,speed:7},this.updateBackgroundVisibility(),this.draw(),this.onGameReset&&this.onGameReset(),this.onScoreUpdate&&this.onScoreUpdate()}gameOver(){this.isGameOver=!0,clearInterval(this.gameLoop),this.gameLoop=null,this.score>this.scores.bestScore&&(this.scores.bestScore=this.score,this.saveScores()),this.onGameOver&&this.onGameOver(this.score)}initializeAsteroids(){const t=2+Math.floor((this.level-1)*.7);this.asteroids=[];for(let i=0;i<t;i++)this.createAsteroid()}createAsteroid(t,i,a="large"){const h=this.isSmallScreen?.75:1,d={large:{radius:25*h,score:20},medium:{radius:15*h,score:50},small:{radius:8*h,score:100}};let o=t,l=i;if(o===void 0||l===void 0){const n=this.isSmallScreen?80:100;let c=!1;for(;!c;)o=Math.random()*this.width,l=-d[a].radius,Math.abs(o-this.ship.x)>n&&(c=!0)}const r=this.isSmallScreen?.6:1;this.asteroids.push({x:o,y:l,xVelocity:(Math.random()*2-1)*1.2*r,yVelocity:(1+Math.random()*1.5+(this.level-1)*.3)*r,radius:d[a].radius,size:a,scoreValue:d[a].score,rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()*.1-.05)*r})}shoot(){!this.gameLoop||this.isPaused||this.isGameOver||this.showStartScreen||this.bullets.push({x:this.ship.x,y:this.ship.y-this.ship.height/2,xVelocity:0,yVelocity:-12,radius:this.isSmallScreen?4:6,lifespan:60})}breakAsteroid(t){const i=this.asteroids[t];if(i.size==="large")for(let a=0;a<2;a++)this.createAsteroid(i.x,i.y,"medium");else if(i.size==="medium")for(let a=0;a<2;a++)this.createAsteroid(i.x,i.y,"small");this.asteroids.splice(t,1)}resetShip(){this.ship.invulnerable=!0,setTimeout(()=>{this.ship.invulnerable=!1},3e3)}update(){this.isPaused||this.isGameOver||(this.updateShip(),this.updateBullets(),this.updateAsteroids(),this.checkCollisions(),this.asteroids.length===0&&(this.level++,this.initializeAsteroids()),this.draw())}updateShip(){var t;this.ship.x+=((t=this.ship.thrust)==null?void 0:t.x)||0,this.ship.x<this.ship.width/2&&(this.ship.x=this.ship.width/2),this.ship.x>this.width-this.ship.width/2&&(this.ship.x=this.width-this.ship.width/2)}updateBullets(){for(let t=this.bullets.length-1;t>=0;t--)this.bullets[t].x+=this.bullets[t].xVelocity,this.bullets[t].y+=this.bullets[t].yVelocity,this.bullets[t].lifespan--,this.bullets[t].lifespan<=0&&this.bullets.splice(t,1)}updateAsteroids(){for(let t=this.asteroids.length-1;t>=0;t--)this.asteroids[t].x+=this.asteroids[t].xVelocity,this.asteroids[t].y+=this.asteroids[t].yVelocity,this.asteroids[t].y>this.height+this.asteroids[t].radius&&(this.asteroids.splice(t,1),this.asteroids.length<12&&this.createAsteroid())}checkCollisions(){for(let t=this.asteroids.length-1;t>=0;t--)for(let i=this.bullets.length-1;i>=0;i--){const a=this.asteroids[t],h=this.bullets[i];if(Math.sqrt(Math.pow(a.x-h.x,2)+Math.pow(a.y-h.y,2))<a.radius+h.radius){this.bullets.splice(i,1),this.score+=a.scoreValue,this.onScoreUpdate&&this.onScoreUpdate(),this.breakAsteroid(t);break}}if(!this.ship.invulnerable)for(let t=this.asteroids.length-1;t>=0;t--){const i=this.asteroids[t],a=Math.sqrt(Math.pow(i.x-this.ship.x,2)+Math.pow(i.y-this.ship.y,2)),h=this.ship.radius*.7;if(a<i.radius+h){this.lives--,this.heartBlinkTime=Date.now(),this.onScoreUpdate&&this.onScoreUpdate(),this.lives<=0?this.gameOver():this.resetShip();break}}}draw(){this.ctx.clearRect(0,0,this.width,this.height),this.drawShip(),this.drawBullets(),this.drawAsteroids(),this.drawHearts(),this.isPaused&&this.drawPauseOverlay(),this.showStartScreen&&this.drawStartScreenOverlay()}drawShip(){var t;this.ship.invulnerable&&Math.floor(Date.now()/100)%2===0||(this.ctx.save(),this.ctx.translate(this.ship.x,this.ship.y),this.shipImageLoaded?(((t=this.ship.thrust)==null?void 0:t.x)!==0&&(this.ctx.shadowColor=getComputedStyle(this.canvas).getPropertyValue("--ship-stroke"),this.ctx.shadowBlur=15,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0),this.ctx.drawImage(this.shipImage,-this.ship.width/2,-this.ship.height/2,this.ship.width,this.ship.height)):(this.ctx.strokeStyle=getComputedStyle(this.canvas).getPropertyValue("--ship-stroke"),this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(0,-this.ship.radius),this.ctx.lineTo(-this.ship.radius,this.ship.radius/2),this.ctx.lineTo(this.ship.radius,this.ship.radius/2),this.ctx.closePath(),this.ctx.stroke()),this.ctx.restore())}drawBullets(){this.bullets.forEach(t=>{if(this.bulletImageLoaded){this.ctx.save(),this.ctx.shadowColor=getComputedStyle(this.canvas).getPropertyValue("--bullet-glow"),this.ctx.shadowBlur=parseInt(getComputedStyle(this.canvas).getPropertyValue("--bullet-shadow-blur"))||10;const i=this.isSmallScreen?6:8,a=t.radius*i,h=t.radius*(i*2);this.ctx.translate(t.x,t.y),this.ctx.rotate(-Math.PI/2),this.ctx.drawImage(this.bulletImage,-a/2,-h/2,a,h),this.ctx.restore()}else this.ctx.save(),this.ctx.fillStyle=getComputedStyle(this.canvas).getPropertyValue("--bullet-fill"),this.ctx.shadowColor=getComputedStyle(this.canvas).getPropertyValue("--bullet-glow"),this.ctx.shadowBlur=parseInt(getComputedStyle(this.canvas).getPropertyValue("--bullet-shadow-blur"))||10,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.radius,0,Math.PI*2),this.ctx.fill(),this.ctx.restore()})}drawAsteroids(){this.asteroids.forEach(t=>{this.asteroidImageLoaded?(t.rotation+=t.rotationSpeed,this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.rotation),this.ctx.drawImage(this.asteroidImage,-t.radius,-t.radius,t.radius*2,t.radius*2),this.ctx.restore()):(this.ctx.fillStyle=getComputedStyle(this.canvas).getPropertyValue("--asteroid-fill"),this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.radius,0,Math.PI*2),this.ctx.fill(),this.ctx.shadowColor=getComputedStyle(this.canvas).getPropertyValue("--asteroid-fill"),this.ctx.shadowBlur=10,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0)})}drawHearts(){const t=this.isSmallScreen?20:25,i=this.isSmallScreen?5:8,a=this.isSmallScreen?5:10;this.ctx.save(),this.ctx.font=`${t}px Arial`,this.ctx.textAlign="center",this.ctx.textBaseline="middle";const h=Date.now()-this.heartBlinkTime,d=h<1e3;for(let o=0;o<this.lives;o++){const l=this.width-a-t/2-o*(t+i),r=a+t/2;if(this.ctx.save(),d&&o===this.lives-1){const n=1+Math.sin(h/50)*.3;this.ctx.translate(l,r),this.ctx.scale(n,n),this.ctx.translate(-l,-r),this.ctx.fillStyle=getComputedStyle(this.canvas).getPropertyValue("--heart-hit-fill"),this.ctx.shadowColor=getComputedStyle(this.canvas).getPropertyValue("--heart-hit-fill")}else this.ctx.fillStyle=getComputedStyle(this.canvas).getPropertyValue("--heart-fill"),this.ctx.shadowColor=getComputedStyle(this.canvas).getPropertyValue("--heart-fill");this.ctx.shadowBlur=15,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0,this.ctx.fillText("❤",l,r),this.ctx.restore()}this.ctx.restore()}drawPauseOverlay(){this.ctx.fillStyle=getComputedStyle(this.canvas).getPropertyValue("--overlay-bg"),this.ctx.fillRect(0,0,this.width,this.height),this.ctx.fillStyle=getComputedStyle(this.canvas).getPropertyValue("--overlay-text"),this.ctx.font=`bold ${this.isSmallScreen?"24px":"30px"} Arial`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.shadowColor=getComputedStyle(this.canvas).getPropertyValue("--overlay-text"),this.ctx.shadowBlur=10,this.ctx.fillText("PAUSED",this.width/2,this.height/2)}drawStartScreenOverlay(){this.ctx.fillStyle=getComputedStyle(this.canvas).getPropertyValue("--overlay-bg"),this.ctx.fillRect(0,0,this.width,this.height),this.ctx.fillStyle=getComputedStyle(this.canvas).getPropertyValue("--overlay-text"),this.ctx.font=`bold ${this.isSmallScreen?"24px":"30px"} Arial`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.shadowColor=getComputedStyle(this.canvas).getPropertyValue("--overlay-text"),this.ctx.shadowBlur=10,this.ctx.fillText("PRESS START",this.width/2,this.height/2)}moveLeft(){this.ship.thrust={x:-this.ship.speed,y:0}}moveRight(){this.ship.thrust={x:this.ship.speed,y:0}}stopMoving(){this.ship.thrust={x:0,y:0}}}document.addEventListener("DOMContentLoaded",()=>{const e=new p("game-board");window.addEventListener("resize",()=>{const s=e.canvas.parentElement;e.canvas.width=s.clientWidth,e.canvas.height=s.clientHeight,e.width=e.canvas.width,e.height=e.canvas.height,e.isSmallScreen=window.innerWidth<=350,e.ship.radius=e.isSmallScreen?12:15,e.ship.width=e.isSmallScreen?30:40,e.ship.height=e.isSmallScreen?30:40,window.innerWidth<=768?e.canvas.style.margin="0":e.canvas.style.margin="0.4rem auto",e.ship.x=Math.min(e.ship.x,e.width-e.ship.width/2),e.ship.y=e.height-60,e.draw()});const t=document.getElementById("start-button"),i=document.getElementById("pause-button"),a=document.getElementById("restart-button"),h=document.getElementById("game-over"),d=document.getElementById("final-score"),o=document.getElementById("score"),l=document.getElementById("best-score"),r=document.getElementById("left-button"),n=document.getElementById("right-button"),c=document.getElementById("fire-button");function u(){o.textContent=e.score,l.textContent=e.scores.bestScore}e.onScoreUpdate=u,e.onGameStart=()=>{t.textContent="Restart",i.disabled=!1},e.onGamePause=()=>{i.textContent="Resume",t.textContent="Restart"},e.onGameResume=()=>{i.textContent="Pause"},e.onGameReset=()=>{t.textContent="Start Game",i.textContent="Pause",i.disabled=!0},e.onGameOver=s=>{d.textContent=s,h.classList.add("visible"),t.textContent="Start Game",i.disabled=!0,u()},t.addEventListener("click",()=>{e.isPaused?(e.reset(),e.start()):(e.showStartScreen||e.isGameOver||e.reset(),e.start())}),i.addEventListener("click",()=>{e.gameLoop&&(e.isPaused?e.resume():e.pause())}),a.addEventListener("click",()=>{e.reset(),h.classList.remove("visible"),u()}),r.addEventListener("mousedown",s=>{s.preventDefault(),e.moveLeft()}),r.addEventListener("mouseup",s=>{s.preventDefault(),e.stopMoving()}),r.addEventListener("touchstart",s=>{s.preventDefault(),e.moveLeft()}),r.addEventListener("touchend",s=>{s.preventDefault(),e.stopMoving()}),n.addEventListener("mousedown",s=>{s.preventDefault(),e.moveRight()}),n.addEventListener("mouseup",s=>{s.preventDefault(),e.stopMoving()}),n.addEventListener("touchstart",s=>{s.preventDefault(),e.moveRight()}),n.addEventListener("touchend",s=>{s.preventDefault(),e.stopMoving()}),c.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),!e.showStartScreen&&!e.isGameOver&&e.gameLoop&&e.shoot()}),c.addEventListener("mousedown",s=>{s.preventDefault(),s.stopPropagation(),!e.showStartScreen&&!e.isGameOver&&e.gameLoop&&e.shoot()}),c.addEventListener("touchstart",s=>{s.preventDefault(),s.stopPropagation(),!e.showStartScreen&&!e.isGameOver&&e.gameLoop&&e.shoot()}),document.addEventListener("keydown",s=>{if(["ArrowLeft","ArrowRight"," "].includes(s.key)&&s.preventDefault(),e.showStartScreen&&s.key===" "){e.start();return}if(!(!e.gameLoop||e.isPaused||e.isGameOver))switch(s.key){case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;case" ":e.shoot();break}}),document.addEventListener("keyup",s=>{if(["ArrowLeft","ArrowRight"].includes(s.key)&&s.preventDefault(),!(!e.gameLoop||e.isPaused||e.isGameOver))switch(s.key){case"ArrowLeft":case"ArrowRight":e.stopMoving();break}}),u()});
