import"./main-DHHuibfa.js";class m{constructor(e){this.canvas=document.getElementById(e),this.ctx=this.canvas.getContext("2d"),this.gridSize=20,this.tileSize=this.canvas.width/this.gridSize,this.reset(),this.loadScores(),this.canvas.addEventListener("touchmove",i=>{i.preventDefault()},{passive:!1})}reset(){this.snake=[{x:10,y:10},{x:9,y:10},{x:8,y:10}],this.direction="right",this.nextDirection="right",this.food=this.generateFood(),this.score=0,this.gameLoop=null,this.isPaused=!1,this.isGameOver=!1,this.lastDirectionChange=Date.now()}loadScores(){const e=localStorage.getItem("snakeScores");this.scores=e?JSON.parse(e):{bestScore:0}}saveScores(){localStorage.setItem("snakeScores",JSON.stringify(this.scores))}generateFood(){let e;do e={x:Math.floor(Math.random()*this.gridSize),y:Math.floor(Math.random()*this.gridSize)};while(this.snake.some(i=>i.x===e.x&&i.y===e.y));return e}start(){this.gameLoop||(this.gameLoop=setInterval(()=>this.update(),150),this.draw())}pause(){this.isPaused=!0}resume(){this.isPaused=!1}update(){if(this.isPaused||this.isGameOver)return;this.direction=this.nextDirection;const e={...this.snake[0]};switch(this.direction){case"up":e.y--;break;case"down":e.y++;break;case"left":e.x--;break;case"right":e.x++;break}if(this.checkCollision(e)){this.gameOver();return}this.snake.unshift(e),e.x===this.food.x&&e.y===this.food.y?(this.score+=10,this.food=this.generateFood(),this.onScoreUpdate&&this.onScoreUpdate()):this.snake.pop(),this.draw()}checkCollision(e){return e.x<0||e.x>=this.gridSize||e.y<0||e.y>=this.gridSize?!0:this.snake.some(i=>i.x===e.x&&i.y===e.y)}draw(){this.ctx.fillStyle="#1a1a1a",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#646cff",this.snake.forEach((e,i)=>{this.ctx.fillRect(e.x*this.tileSize,e.y*this.tileSize,this.tileSize-1,this.tileSize-1)}),this.ctx.fillStyle="#ff4444",this.ctx.fillRect(this.food.x*this.tileSize,this.food.y*this.tileSize,this.tileSize-1,this.tileSize-1)}changeDirection(e){const i={up:"down",down:"up",left:"right",right:"left"},c=Date.now();c-this.lastDirectionChange<100||i[e]!==this.direction&&(this.nextDirection=e,this.lastDirectionChange=c)}gameOver(){this.isGameOver=!0,clearInterval(this.gameLoop),this.gameLoop=null,this.score>this.scores.bestScore&&(this.scores.bestScore=this.score,this.saveScores()),this.onGameOver&&this.onGameOver(this.score)}}const t=new m("game-board"),n=document.getElementById("start-button"),o=document.getElementById("pause-button"),S=document.getElementById("restart-button"),d=document.getElementById("game-over"),p=document.getElementById("final-score"),v=document.getElementById("score"),y=document.getElementById("best-score"),a=document.getElementById("game-board"),x=document.getElementById("swipe-instruction"),b=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);b||(x.style.display="none");function r(){v.textContent=t.score,y.textContent=t.scores.bestScore}n.addEventListener("click",()=>{t.start(),n.disabled=!0});o.addEventListener("click",()=>{t.isPaused?(t.resume(),o.textContent="Pause"):(t.pause(),o.textContent="Resume")});S.addEventListener("click",()=>{t.reset(),d.classList.remove("visible"),n.disabled=!1,o.textContent="Pause"});let l=0,u=0,g=0,f=0,h=20;a.addEventListener("touchstart",s=>{l=s.changedTouches[0].screenX,u=s.changedTouches[0].screenY},!1);a.addEventListener("touchmove",s=>{s.preventDefault()},{passive:!1});a.addEventListener("touchend",s=>{g=s.changedTouches[0].screenX,f=s.changedTouches[0].screenY,w()},!1);function w(){const s=g-l,e=f-u;Math.abs(s)>Math.abs(e)?Math.abs(s)>h&&(s>0?t.changeDirection("right"):t.changeDirection("left")):Math.abs(e)>h&&(e>0?t.changeDirection("down"):t.changeDirection("up"))}document.addEventListener("keydown",s=>{switch(s.key){case"ArrowLeft":t.changeDirection("left");break;case"ArrowRight":t.changeDirection("right");break;case"ArrowUp":t.changeDirection("up");break;case"ArrowDown":t.changeDirection("down");break}});t.onGameOver=s=>{p.textContent=s,d.classList.add("visible"),n.disabled=!1,r()};t.onScoreUpdate=r;r();
